LAMMPS (10 Jan 2012)
# 2d SRD test: big + small particles

units		lj
atom_style	sphere
atom_modify	first big
dimension	2

# create big particles with sigma 1.0

lattice		sq 0.4
Lattice spacing in x,y,z = 1.58114 1.58114 1.58114
region		box block 0 10 0 10 -0.5 0.5
create_box	2 box
Created orthogonal box = (0 0 -0.790569) to (15.8114 15.8114 0.790569)
  2 by 2 by 1 MPI processor grid
create_atoms	1 region box
Created 100 atoms
set		type 1 mass 1.0
  100 settings made for mass
set		type 1 diameter 1.0
  100 settings made for diameter

group		big type 1
100 atoms in group big
velocity	big create 1.44 87287 loop geom

# equilibrate big particles

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.0

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

fix		1 big nve
fix		2 all enforce2d

run		1000
Memory usage per processor = 2.74723 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0         1.44     -0.54272            0      0.88288    -0.041088 
    1000    1.8791467  -0.97185784            0    0.8884974   0.61487657 
Loop time of 0.0149925 on 4 procs for 1000 steps with 100 atoms

Pair  time (%) = 0.00214541 (14.3099)
Neigh time (%) = 0.000690401 (4.60498)
Comm  time (%) = 0.00878567 (58.6005)
Outpt time (%) = 1.81794e-05 (0.121257)
Other time (%) = 0.00335282 (22.3634)

Nlocal:    25 ave 26 max 23 min
Histogram: 1 0 0 0 0 0 1 0 0 2
Nghost:    47 ave 48 max 46 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:    114.75 ave 124 max 100 min
Histogram: 1 0 0 0 0 1 0 0 0 2

Total # of neighbors = 459
Ave neighs/atom = 4.59
Neighbor list builds = 129
Dangerous builds = 0

unfix		1
unfix		2

# add small particles as hi density lattice

lattice		sq 0.4
Lattice spacing in x,y,z = 1.58114 1.58114 1.58114
region		plane block 0 10 0 10 -0.001 0.001
lattice		sq 85.0
Lattice spacing in x,y,z = 0.108465 0.108465 0.108465
create_atoms	2 region plane
Created 21316 atoms
set		type 2 mass 0.01
  21316 settings made for mass
set		type 2 diameter 0.0
  21316 settings made for diameter

group		small type 2
21316 atoms in group small

velocity	small create 1.0 593849 loop geom

# delete overlaps
# must set 1-2 cutoff to non-zero value

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.5

delete_atoms	overlap 0.5 small big
Deleted 6700 atoms, new total = 14716

# SRD run

reset_timestep	0

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

communicate	multi group big vel yes
neigh_modify	include big

# no pairwise interactions with small particles

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.0

# use fix SRD to push small particles out from inside big ones

timestep	0.001

fix		1 big nve
fix	        2 small srd 20 big 1.0 0.25 49894 		  radius 0.88 search 0.2 collision slip
fix		3 all enforce2d

# diagnostics

compute		tbig big temp
variable	pebig equal pe*atoms/count(big)
variable	ebig equal etotal*atoms/count(big)
thermo_style	custom step temp f_2[7] etotal v_pebig v_ebig press 		f_2[1] f_2[2] f_2[3] f_2[4] f_2[5] 		f_2[6] f_2[8] f_2[9] f_2[10]

thermo_modify	temp tbig
WARNING: Temperature for thermo pressure is not for group all (thermo.cpp:442)
thermo		100
dump		1 all atom 250 dump.srd.mixture

run		5000
SRD info:
  SRD/big particles = 14616 100
  big particle diameter max/min = 0.88 0.88
  SRD temperature & lamda = 1 0.2
  SRD max distance & max velocity = 0.8 40
  SRD grid counts: 63 63 1
  SRD grid size: request, actual (xyz) = 0.25, 0.250974 0.250974 1.58114
  SRD per actual grid cell = 4.86648
  SRD viscosity = 0.463448
  big/SRD mass density ratio = 2.12808
WARNING: Fix srd grid size > 1/4 of big particle diameter (fix_srd.cpp:2718)
  # of rescaled SRD velocities = 0
  ave/max small velocity = 13.2944 24.262
  ave/max big velocity = 1.69284 5.10989
Memory usage per processor = 6.32655 Mbytes
Step Temp 2[7] TotEng pebig ebig Press 2[1] 2[2] 2[3] 2[4] 2[5] 2[6] 2[8] 2[9] 2[10] 
       0    1.8791467            0 0.0060376284  -0.97185784    0.8884974   0.61487657            0            0            0            0            0            0            0            0            0 
     100    1.4044369         3969 0.0030633087  -0.93959598   0.45079651   0.78900114         7464           99           99            0            0        22500         3312   0.93283021            0 
     200    1.1569395         3969 0.0010544039  -0.99020406   0.15516608   0.50132859         7393           82           82            0            0        22500         3291   0.92342254            0 
     300    1.0082066         3969 1.5754289e-06  -0.99789266 0.00023184012   0.36859357         7443           90           90            0            0        22500         3298   0.93222633            0 
     400    1.1459472         3969 0.0010570023  -0.97893929   0.15554845   0.47616067         7327           81           81            0            0        22500         3297   0.91766446            0 
     500    1.0836955         3969 0.00072569678    -0.966065   0.10679354   0.49205907         7447           89           89            0            0        22500         3258   0.93553253            0 
     600   0.95868561         3969 -0.00031108604  -0.99487817 -0.045779421    0.3676888         7488           90           90            0            0        22500         3280   0.91061957            0 
     700   0.98121671         3969 -0.00022225428   -1.0041115  -0.03270694    0.3605398         7393           80           80            0            0        22500         3299   0.90992183            0 
     800    1.0870893         3969 0.00028589178   -1.0341466  0.042071834    0.3576364         7506           96           96            0            0        22500         3290   0.92887007            0 
     900     1.087553         3969 8.795578e-05   -1.0637339  0.012943573   0.28026879         7405           82           82            0            0        22500         3301   0.91599453            0 
    1000    1.0160539         3969 7.5618714e-05  -0.99476531   0.01112805   0.60009776         7334           88           88            0            0        22500         3296   0.92803837            0 
    1100   0.94619807         3969 -0.00084794884   -1.0615202  -0.12478415   0.36153566         7565           89           89            0            0        22500         3300   0.93685597            0 
    1200    1.2187057         3969 0.00079088888   -1.0901314   0.11638721   0.34195358         7558           94           94            0            0        22500         3281   0.92133419            0 
    1300    1.0297116         3969 -6.2029069e-05   -1.0285427 -0.0091281978   0.44490154         7365           76           76            0            0        22500         3273   0.92349253            0 
    1400    1.0723726         3969 3.8902675e-05    -1.055924 0.0057249176   0.40617642         7524           90           90            0            0        22500         3280   0.92787441            0 
    1500    1.0661279         3969 -0.00010841884   -1.0714216 -0.015954917   0.49701435         7285           69           69            0            0        22500         3295   0.92862687            0 
    1600    1.2175256         3969 0.00087968156   -1.0758964   0.12945394   0.64512981         7286           89           89            0            1        22500         3294   0.92600699            0 
    1700    1.1985014         3969 0.0014648642    -0.970947   0.21556942    1.0479949         7228           85           85            0            0        22500         3268   0.92256981            0 
    1800    1.2075839         3969 0.00072247447   -1.0891887   0.10631934   0.57872746         7449           87           87            0            0        22500         3288   0.92069976            0 
    1900    1.2255534         3969 0.00088656095   -1.0828315   0.13046631   0.65685308         7385           76           76            0            0        22500         3291    0.9048111            0 
    2000     1.291624         3969 0.0012489132   -1.0949177   0.18379006   0.54486534         7460           88           88            0            0        22500         3269   0.92086677            0 
    2100    1.1111637         3969 8.680692e-05   -1.0872776  0.012774506   0.54623825         7399           79           79            0            0        22500         3283   0.89787043            0 
    2200    1.1101509         3969 -0.00019790624   -1.1281733 -0.029123882   0.36938914         7394           80           80            0            0        22500         3289   0.92391832            0 
    2300   0.99008142         3969 -0.0010221939   -1.1306067  -0.15042605   0.49715741         7403           77           77            0            0        22500         3298    0.9032635            0 
    2400    1.1298599         3969 -0.00028442155   -1.1604168 -0.041855476   0.62622034         7213           99           99            0            0        22500         3279   0.92291152            0 
    2500   0.96755195         3969 -0.0013882655   -1.1621736  -0.20429715   0.53854953         7302           91           91            0            0        22500         3282    0.9169308            0 
    2600   0.92289325         3969 -0.0018295583   -1.1829021   -0.2692378   0.48117908         7387          114          114            0            0        22500         3292   0.90278484            0 
    2700    1.0556828         3969 -0.0010119543   -1.1940452  -0.14891919   0.38438637         7379           77           77            0            0        22500         3290   0.90840462            0 
    2800   0.96725457         3969 -0.0014988251   -1.1781491   -0.2205671   0.45335869         7311           77           77            0            0        22500         3273   0.91859555            0 
    2900    1.0133684         3969 -0.0012783239   -1.1913529  -0.18811815   0.47922787         7445           91           91            0            0        22500         3282   0.93217047            0 
    3000   0.97710883         3969 -0.0011590153   -1.1378984  -0.17056069   0.64470243         7454           90           90            0            0        22500         3294   0.90446012            0 
    3100   0.85234697         3969 -0.002077265   -1.1495138  -0.30569031   0.55071072         7386           95           95            0            0        22500         3276   0.90586471            0 
    3200     1.052911         3969 -0.00084248304   -1.1663617   -0.1239798   0.49920749         7410           84           84            0            0        22500         3298   0.94126987            0 
    3300    1.1427076         3969 0.00052348324   -1.0542447  0.077035793   0.97657677         7268           70           70            0            0        22500         3281   0.93981555            0 
    3400    1.1749571         3969 -0.00049301879   -1.2357602 -0.072552645    0.2551001         7443           77           77            0            0        22500         3296   0.92174553            0 
    3500   0.99448585         3969 -0.0015705474   -1.2156628  -0.23112176   0.31069295         7502           97           97            0            0        22500         3271   0.94669984            0 
    3600    1.0615674         3969 -0.00088670873   -1.1814398  -0.13048806   0.42774035         7386           70           70            0            0        22500         3298   0.91457914            0 
    3700   0.92549328         3969 -0.0018599812   -1.1899532  -0.27371483   0.36471531         7459           81           81            0            0        22500         3305   0.93382818            0 
    3800   0.85987993         3969 -0.0018189231   -1.1189538  -0.26767272   0.42802928         7232           75           75            0            0        22500         3304   0.91492738            0 
    3900   0.92111833         3969 -0.0011824977   -1.0859235  -0.17401636   0.73992354         7351           80           80            0            0        22500         3298   0.94205739            0 
    4000   0.91817371         3969 -0.0014469814   -1.1219298  -0.21293778   0.64725317         7478           86           86            0            0        22500         3309   0.92689567            0 
    4100    1.0607641         3969 -0.00061451533   -1.1405885 -0.090432076   0.54575249         7474           87           87            0            0        22500         3306   0.94825937            0 
    4200    1.1112883         3969 0.00012926229   -1.0811532  0.019022238   0.71771029         7527           67           67            0            1        22500         3285   0.93577595            0 
    4300    1.3096702         3969 0.00060322354   -1.2078031  0.088770376   0.31006723         7617           88           88            0            0        22500         3291   0.95276158            0 
    4400    1.2076765         3969  0.001009301    -1.047071   0.14852873   0.83105522         7355           97           97            0            0        22500         3293   0.94207048            0 
    4500   0.94049473         3969 -0.0011505342   -1.1004024  -0.16931262   0.46258624         7403           78           78            0            0        22500         3275   0.95198657            0 
    4600    0.8241741         3969 -0.0025714658   -1.1943493  -0.37841691  0.010193689         7604           99           99            0            1        22500         3287   0.94875859            0 
    4700   0.98678642         3969 -0.0011664864   -1.1485787  -0.17166013   0.16963181         7691           94           94            0            0        22500         3289   0.92141605            0 
    4800   0.97602307         3969 -0.0010910984   -1.1268289  -0.16056604   0.24433738         7547           85           85            0            0        22500         3287   0.92130755            0 
    4900    1.0427787         3969 -0.00050976935   -1.1073686 -0.075017657   0.30774039         7563           85           85            0            0        22500         3300   0.92864167            0 
    5000    1.3048873         3969 0.0015736036   -1.0602669   0.23157151   0.49881308         7529          104          104            0            0        22500         3293   0.91471093            0 
Loop time of 1.185 on 4 procs for 5000 steps with 14716 atoms

Pair  time (%) = 0.0118163 (0.997157)
Neigh time (%) = 0.0523425 (4.41711)
Comm  time (%) = 0.077751 (6.56129)
Outpt time (%) = 0.191228 (16.1375)
Other time (%) = 0.851857 (71.887)

Nlocal:    3679 ave 4052 max 3370 min
Histogram: 1 0 0 1 1 0 0 0 0 1
Nghost:    49 ave 53 max 42 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Neighs:    120.5 ave 162 max 85 min
Histogram: 1 0 0 1 0 1 0 0 0 1

Total # of neighbors = 482
Ave neighs/atom = 0.0327535
Neighbor list builds = 250
Dangerous builds = 0

